DELIMITER ;;
CREATE EVENT `clean_token` ON SCHEDULE EVERY 1 YEAR STARTS '2015-01-01 00:00:00' ON COMPLETION NOT PRESERVE ENABLE DO BEGIN
DELETE FROM `token` where created + INTERVAL 2 YEAR > NOW();
END ;;

DELIMITER ;;
CREATE EVENT `SharedSecret` ON SCHEDULE EVERY 1 DAY STARTS '2015-11-25 00:00:00' ON COMPLETION NOT PRESERVE ENABLE DO BEGIN
    DECLARE secret VARCHAR(42);
    SELECT SUBSTR(CONCAT(MD5(RAND()),MD5(RAND())),1,64) INTO secret;
    INSERT INTO `turn_secret` (`realm`,`value`) VALUES ('turn.geant.org',secret);
    DELETE FROM `turn_secret` where realm='turn.geant.og' and timestamp + INTERVAL 1 DAY < NOW();
END ;;
DELIMITER ;
